<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<div th:replace="fragments/header :: header"></div>
<style>
    .petsContainer {
        margin-inline: 10%;
    }

    .btn-heart {
        display: block;
        height: 35px;
        width: 35px;
        border-radius: 50%;
        border: 1px solid red;
    }

    .feather-14 {
        width: 14px;
        height: 14px;
    }

    .feather-16 {
        width: 16px;
        height: 16px;
    }

    .feather-24 {
        width: 24px;
        height: 24px;
    }

    .feather-32 {
        width: 32px;
        height: 32px;
    }

    .btn-heart:focus {
        border: none;
        outline: none;
    }
</style>

<body>
    <div th:replace="fragments/navbar :: navbar"></div>	
    <div class="petsContainer" style="margin-top:70px">
        <div class="row">

            <div class="col-12">
                <div class="row" >	
                	<div sec:authorize="hasAuthority('ROLE_ADMIN')" class="col-12 mt-4" > 
                		<h1 style="color: #ccc" class="text-center" >Mascotas publicadas</h1> 
                	</div>
                	<div sec:authorize="hasAuthority('ROLE_ADOPTER')" class="col-12 mt-4" >
                		<h1 style="color: #ccc" class="text-center" >�Adopta una mascota hoy!</h1>
                		<h3 style="color: #ccc" class="text-center" >y ayudales a conseguir un hogar</h3>
               		</div>
                	<div sec:authorize="hasAuthority('ROLE_VOLUNTEER')" class="col-12 mt-4" > 
                		<h1 style="color: #ccc" class="text-center" >Publica una mascota</h1> 
                		<h3 style="color: #ccc" class="text-center" >y asi podr� encontrar un hogar </h3>
                	</div>
                    <div class="offset-md-8  col-12 col-md-4 " >
                        <label for="basic-url">Busqueda</label>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" id="basic-url" aria-describedby="basic-addon3">
                            <div class="input-group-append">
                                <span class="input-group-text">Buscar</span>
                            </div>
                        </div>
                    </div>
                </div>


            </div>

        </div>
        <div class="row mt-3">
            <div class="col-12 col-sm-6 col-md-4 col-lg-3">

                <label for="sex">Sexo</label>
                <div class="input-group">
                    <select id="sex" class="form-control">
                        <option selected>Seleccione...</option>
                        <option>Macho</option>
                        <option>Hembra</option>
                    </select>
                </div>

                <label for="size">Tamaño</label>
                <div class="input-group">
                    <select id="size" class="form-control">
                        <option selected>Seleccione...</option>
                        <option>Pequeño</option>
                        <option>Mediano</option>
                        <option>Grande</option>
                    </select>
                </div>

                <label for="color">Color</label>
                <div class="input-group">
                    <select class="custom-select" id="color">
                        <option th:each="tmpColor: ${colorsList}" th:text="${tmpColor.name}" th:value="${tmpColor.id}" ></option>
                    </select>
                </div>

                <div class="text-right mt-3">
                    <button class="btn btn-primary">
                        <span class="material-icons" style="vertical-align: middle;">
                            filter_list
                        </span>
                        &nbsp;Filtrar
                    </button>
                </div>

            </div>

            <div class="col-12 col-sm-6 col-md-4 col-lg-3" th:each="tmpPet: ${listPets}">
                <div class="card mb-2">
                    <img class="card-img-top" th:src="@{/imagenesPet/{i} (i = ${tmpPet.image})}">
                    <div class="card-body">
                        <h4 class="card-title">[[${tmpPet.name}]]</h4>
                        <p class="card-text" th:utext="${tmpPet.description}"></p>
                            <!-- <button class="btn btn-primary" id="myModal" data-toggle="modal" data-target="#modalInformacionMascota" th:onclick="'javascript:showPet('+${tmpPet.id}+')'">
                                <a style="color:white"><span class="material-icons"
                                    style="vertical-align: middle;">add</span>&nbsp; Mas información</a>
                            </button> -->
                            <!-- <button class="btn btn-success" id="myModal" data-toggle="modal" th:attr="data-target=${'#petModal'+tmpPet.id}">¡Adoptar!</button> 
                            <a id="myModal" data-toggle="modal" data-target="#exampleModal" th:onclick="'javascript:showPet('+${tmpPet.id}+')'" > ¡Adoptar! </a>-->
                            <button class="btn btn-success" data-toggle="modal" th:attr="data-target=${'#editModal'+tmpPet.id}" data-row="${tmpPet}">Mas información</button >
                            <a sec:authorize="hasAuthority('ROLE_VOLUNTEER')" th:if="${tmpPet.user.username.equals(usernameFromModel)}" th:href="@{/mascotas/mascota/{id} (id=${tmpPet.id})}" class="btn btn-info">Editar</a>
                    </div>

                    <div class="card-footer text-muted">
                        <div class="row">
                            <div class="col-12 text-right">
                            	<div th:if="${tmpPet.status.equals('requestedByYou') || tmpPet.status.equals('lovedIt')}"  >
                            		<form th:action="@{/mascotas/removeRequest}" method="POST" th:attr="id=${'removalForm' + tmpPet.id}" >
                            			<input type="hidden" name="petId" th:value="${tmpPet.id}" >
                            			<input type="hidden" name="location" th:value="${location}" >
	                            		<button type="button" th:onclick="'javascript:removeRequest(\''+${tmpPet.id}+'\');'" class="btn btn-warning" >Retirar solicitud</button>
                            		</form>
	                            	<h4 >Solicitada</h4>
                            	</div>
                            
                            
                    			<div sec:authorize="hasAuthority('ROLE_ADOPTER')" >
                        			<div th:if="!(${tmpPet.status.equals('lovedIt') || tmpPet.status.equals('heart')})" >
                            		<form th:action="@{/mascotas/heartOne}" method="POST" >
                            			<input type="hidden" name="petId" th:value="${tmpPet.id}" >
                            			<input type="hidden" name="location" th:value="${location}" >
                            			<button  
                            				class="btn btn-outline-gray" 
                            				style="border : none; right: 0px !important; " 
                           				>
                           				
                    
	                                    <i class="feather-14" data-feather="heart"></i>
		                                    Dar coraz�n
		                                </button>
                            		</form>
                            	</div>
	                            	<div th:if="${tmpPet.status.equals('lovedIt') || tmpPet.status.equals('heart')}" >
	                            		<form th:action="@{/mascotas/removeHeart}" method="POST" >
	                            			<input type="hidden" name="petId" th:value="${tmpPet.id}" >
	                            			<input type="hidden" name="location" th:value="${location}" >
	                            			<button  
	                            				class="btn btn-outline-gray" 
	                            				style="border : none; right: 0px !important; " 
	                           				>
			                                    <i class="feather-14" data-feather="heart"></i>
			                                    Remover coraz�n
			                                </button>
	                            		</form>
	                            	</div>
            					</div>
                            	
                                
                                
                                
                                
                            </div>
                        </div>

                    </div>
                </div>
            </div>

<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" 
     aria-hidden="true" th:each="pet : ${listPets}" th:attr="id=${'editModal' + pet.id}">
    <div class="modal-dialog  modal-lg">
        <div class="modal-content">
            <div >
			  <div class="modal-body">
			    	<div class="row" >
                        <div class="container">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-12 col-sm-4">
                                            <img class="img-fluid img-thumbnail mx-auto d-block mb-3" height="80rem"
                                                th:src="@{/imagenesPet/{i} (i = ${pet.image})}">
                                            <div class="row">
                                            </div>
                                        </div>
                                        <div class="row col-12 col-sm-8">
                                            <div class="col-12">
                                                <label for="name" style="color: #687281;"><b>Nombre de la mascota </b></label>
                                                <p>[[${pet.name}]]</p>
                                            </div>
                                            <div class="col-6 col-sm-3">
                                                <label for="name" style="color: #687281;"><b>Sexo</b></label>
                                                <p th:text="${pet.sex == 'M'}  ? 'Macho' : 'Hembra'"></p  >
                                            </div>
                                            <div class="col-6 col-sm-3">
                                                <label for="name" style="color: #687281;"><b>Edad</b></label>
                                                <p>[[${pet.age + " " + pet.unitAge}]]</p>
                                            </div>
                                            <div class="col-6 col-sm-3">
                                                <label for="name" style="color: #687281;"><b>Tamaño</b></label>
                                                <p>[[${pet.size}]]</p>
                                            </div>
                                            <div class="col-6 col-sm-3">
                                                <label for="name" style="color: #687281;"><b>Color</b></label>
                                                <p>[[${pet.color.name}]]</p>
                                            </div>
                                            <div class="col-6 col-sm-3">
                                                <label for="name" style="color: #687281;"><b>Carácter</b></label>
                                                <p>[[${pet.personality.name}]]</p>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <label for="description" style="color: #687281;"><b>Descripción de la mascota </b></label>
                                            <p style="text-align: justify;" th:utext="${pet.description}"></p>
                                        </div>
	                                        <div class="col-12 d-flex justify-content-end" >
		                                        <form th:id="'requestAPetForm' + ${pet.id}" th:if="${!pet.status.equals('requestedByYou')}" sec:authorize="hasAuthority('ROLE_ADOPTER')" th:action="@{/mascotas/requestAdoption}" method='POST' >
                		                        	<input name="petId" type="hidden" th:value="${pet.id}" >
                		                        	<input name="location" type="hidden" th:value="${location}" > 
	                    	                    	<button type="button" th:onclick="javascript:confirmBeforeRequesting([[${pet.id}]], [[${pet.name}]]);"  class="btn btn-success" > Solicitar adopci�n </button>
        		                                </form>
	                                        </div>                                        
                                    </div>
                                </div>
                        </div>
                    </div>
			    </div>
			
			    <div class="modal-footer">
			    </div>
			  </div>
			</div>
		</div>
	  </div>
	</div>

        </div>

    </div>




    <script th:replace="fragments/footer :: footer"></script>
    <script>
	$("#exampleModal").modal("hide");
 
    function showPet(ID) {
        $("#id").val(ID);
    }
    </script>
    <script th:src="@{/js/petFunctions.js}" ></script>
</body>

</html>